<div class="container">
  <h1>単語検索</h1>
  <div class="words_search">
    <%= search_form_for @q do |f| %>
      <div class="row">
        <%= f.label :term_cont, "部分一致検索", placeholder: "単語を入力してください", class: "col-sm-12 col-md-3" %>
        <%= f.search_field :term_cont, class: "search_field" %>
      </div>
      <div class="row">
        <%= f.label :created_at, '登録日付検索', class: "col-md-12 col-lg-3" %>
        <div class="col-lg-8">
          <div class="row">
            <div class="col-sm-12 col-md-6">
              開始日<%= f.date_select :created_at_gteq,
                                include_blank: true,
                                use_month_numbers: true,
                                start_year: 2018,
                                end_year: Date.today.year,
                                date_separator: '/'
              %>
            </div>
            <div class="col-sm-12 col-md-6">
              終了日<%= f.date_select :created_at_lteq_end_of_day,
                                include_blank: true,
                                use_month_numbers: true,
                                start_year: 2018,
                                end_year: Date.today.year,
                                date_separator: '/'
               %>
             </div>
            </div>
         </div>
       </div>

      <%= f.submit "検索", class: :button %>
      <%= link_to 'クリア', request.path, class: :clear_button %>

    <% end %>
  </div>

  <div class="words_list">
    <div class="words_list_inner">
      <div class="words_list_inner_header">
        <p class="row"><%= sort_link(@q, :term, '登録した単語一覧', default_order: :desc) %></p>
      </div>

      <div class="words_list_inner_body">
        <div class="row">
        <% @search_results.each do |search_result| %>
          <% if search_result.user_id == current_user.id %>
            <p class="col-sm-12 col-md-6 col-lg-4"><%= link_to word_path(search_result.id) do %><%= search_result.term %><% end %></p>
          <% end %>
        <% end %>

        <% unless @search_results.find_by(user_id: current_user.id).present? %>
          <p><i class="fas fa-exclamation-triangle"></i>現在登録している単語はありません。新しい単語の登録から早速始めましょう。</p>
        <% end %>

        </div>
      </div>
    </div>

    <p><%= link_to '新しい単語の登録', new_word_path, class: :link_button %></p>
    <p class="words_list_footer">登録単語数&nbsp全<%= @words.size %>個</p>
  </div>

  <div class="words_to_slack">
    <h1>Slackで共有する</h1>
    <div class="send_registered_words_of_the_day">
      <p class="to_slack">今日登録した単語をslackに送りましょう。(注：卒業課題用のslackチャンネルは&nbsp<%= link_to  '#test_kaoru2' ,'https://diveintocode.slack.com/messages/CCA5K407M/details/', target: "_new" %>です）</p>
        <% @registered_words_of_the_day.each do |my_registered_word| %>
          <% if my_registered_word.user_id == current_user.id %>
            <% if my_registered_word.present? %>
              <%= link_to my_registered_word.term, word_path(my_registered_word.id), class: :link_button %>&nbsp
            <% end %>
          <% end %>
        <% end %>

        <% unless @registered_words_of_the_day.find_by(user_id: current_user.id).present? %>
          <i class="fas fa-exclamation-triangle"></i>今日登録した単語はありません。
        <% end %>
        <%= button_to 'Slackに送る', button_path, class: :button, method: :get, title: "Slackへの送信の確認", data: {confirm: '本当に送りますか？', cancel: "やめる", commit: "送る"} %>
    </div>
  </div>

  <div class="words_test">
    <h5>英単語スライダー</h5>
    <div class="words_test_inner">
      <% if @words.present? %>
        <div class="random_tester">
          <div id="test_slider">
            <h1><%= @random_word.term %></h1>
            <p><%= link_to "詳細を確認", word_path(@random_word) %></p>
          </div>
          <%= link_to "次の単語", render_test_word_path, remote: true, class: :link_button %>
        </div>
      <% else %>
        <p><i class="fas fa-exclamation-triangle"></i>現在登録している単語はありません。</p>
      <% end %>
    </div>
  </div>
</div>
